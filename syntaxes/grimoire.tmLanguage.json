{
    "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
    "name": "Grimoire",
    "patterns": [
        {
            "include": "#use"
        },
        {
            "include": "#global-keyword"
        },
        {
            "include": "#type"
        },
        {
            "include": "#assignment"
        },
        {
            "include": "#template-decl"
        },
        {
            "include": "#type-decl"
        },
        {
            "include": "#enum-decl"
        },
        {
            "include": "#class-decl"
        },
        {
            "include": "#function-decl"
        },
        {
            "include": "#task-decl"
        },
        {
            "include": "#action-decl"
        },
        {
            "include": "#comment"
        },
        {
            "include": "#string"
        },
        {
            "include": "#block"
        }
    ],
    "repository": {
        "function-decl": {
            "begin": "\\b(fonction|function)\\b",
            "beginCaptures": {
                "0": {
                    "name": "keyword.control.function.grimoire"
                }
            },
            "end": "(?<=})",
            "patterns": [
                {
                    "include": "#comment"
                },
                {
                    "include": "#operator"
                },
                {
                    "match": "\\b(en|as)\\b",
                    "name": "keyword.control.as.grimoire"
                },
                {
                    "include": "#template-variable-list"
                },
                {
                    "include": "#block"
                },
                {
                    "include": "#type"
                },
                {
                    "include": "#parameter-list"
                },
                {
                    "match": "[_[:alpha:]][_[:alnum:]]*[\\?|\\!]?",
                    "name": "entity.name.function.grimoire"
                }
            ]
        },
        "task-decl": {
            "begin": "\\b(tâche|task)\\b",
            "beginCaptures": {
                "0": {
                    "name": "keyword.control.function.grimoire"
                }
            },
            "end": "(?<=})",
            "patterns": [
                {
                    "include": "#comment"
                },
                {
                    "include": "#template-variable-list"
                },
                {
                    "include": "#block"
                },
                {
                    "include": "#type"
                },
                {
                    "include": "#parameter-list"
                },
                {
                    "match": "[_[:alpha:]][_[:alnum:]]*[\\?|\\!]?",
                    "name": "entity.name.function.grimoire"
                }
            ]
        },
        "action-decl": {
            "begin": "\\b(action)\\b",
            "beginCaptures": {
                "0": {
                    "name": "keyword.control.function.grimoire"
                }
            },
            "end": "(?<=})",
            "patterns": [
                {
                    "include": "#comment"
                },
                {
                    "include": "#block"
                },
                {
                    "include": "#type"
                },
                {
                    "include": "#parameter-list"
                },
                {
                    "match": "[_[:alpha:]][_[:alnum:]]*[\\?|\\!]?",
                    "name": "entity.name.function.grimoire"
                }
            ]
        },
        "parameter-list": {
            "begin": "\\(",
            "beginCaptures": {
                "0": {
                    "name": "punctuation.parenthesis.open.grimoire"
                }
            },
            "end": "\\)",
            "endCaptures": {
                "0": {
                    "name": "punctuation.parenthesis.close.grimoire"
                }
            },
            "patterns": [
                {
                    "include": "#comment"
                },
                {
                    "include": "#type"
                },
                {
                    "begin": "(?<=,|\\(\\s*)",
                    "end": "[_[:alpha:]][_[:alnum:]]*[\\?|\\!]?",
                    "endCaptures": {
                        "0": {
                            "name": "storage.type.grimoire"
                        }
                    }
                },
                {
                    "name": "variable.parameter.grimoire",
                    "match": "[_[:alpha:]][_[:alnum:]]*[\\?|\\!]?"
                },
                {
                    "include": "#comma"
                }
            ]
        },
        "template-variable-list": {
            "begin": "<",
            "beginCaptures": {
                "0": {
                    "name": "punctuation.bracket.angle.open.grimoire"
                }
            },
            "end": ">",
            "endCaptures": {
                "0": {
                    "name": "punctuation.bracket.angle.close.grimoire"
                }
            },
            "patterns": [
                {
                    "include": "#comment"
                },
                {
                    "name": "variable.parameter.grimoire",
                    "match": "[_[:alpha:]][_[:alnum:]]*[\\?|\\!]?"
                },
                {
                    "include": "#comma"
                }
            ]
        },
        "template-list": {
            "begin": "<",
            "beginCaptures": {
                "0": {
                    "name": "punctuation.bracket.angle.open.grimoire"
                }
            },
            "end": ">",
            "endCaptures": {
                "0": {
                    "name": "punctuation.bracket.angle.close.grimoire"
                }
            },
            "patterns": [
                {
                    "include": "#comment"
                },
                {
                    "include": "#type"
                },
                {
                    "name": "storage.type.grimoire",
                    "match": "[_[:alpha:]][_[:alnum:]]*[\\?|\\!]?"
                },
                {
                    "include": "#comma"
                }
            ]
        },
        "global-keyword": {
            "match": "\\b(public)\\b",
            "name": "storage.modifier.grimoire"
        },
        "type": {
            "patterns": [
                {
                    "match": "\\b(soit|let|ent|int|réel|float|bool|chaîne|string)\\b",
                    "name": "storage.type.grimoire"
                },
                {
                    "begin": "\\b(liste|list)\\b",
                    "beginCaptures": {
                        "0": {
                            "name": "storage.type.grimoire"
                        }
                    },
                    "end": "(?<=\\))",
                    "patterns": [
                        {
                            "include": "#comment"
                        },
                        {
                            "begin": "\\(",
                            "beginCaptures": {
                                "0": {
                                    "name": "punctuation.parenthesis.open.grimoire"
                                }
                            },
                            "end": "\\)",
                            "endCaptures": {
                                "0": {
                                    "name": "punctuation.parenthesis.close.grimoire"
                                }
                            },
                            "patterns": [
                                {
                                    "include": "#comment"
                                },
                                {
                                    "include": "#type"
                                }
                            ]
                        }
                    ]
                },
                {
                    "begin": "\\b(tâche|task|fonction|function)\\b\\s*(?=\\()",
                    "beginCaptures": {
                        "0": {
                            "name": "storage.type.grimoire"
                        }
                    },
                    "end": "(?<=\\))",
                    "patterns": [
                        {
                            "include": "#comment"
                        },
                        {
                            "begin": "\\(",
                            "beginCaptures": {
                                "0": {
                                    "name": "punctuation.parenthesis.open.grimoire"
                                }
                            },
                            "end": "\\)",
                            "endCaptures": {
                                "0": {
                                    "name": "punctuation.parenthesis.close.grimoire"
                                }
                            },
                            "patterns": [
                                {
                                    "include": "#comment"
                                },
                                {
                                    "include": "#type"
                                },
                                {
                                    "match": ",",
                                    "name": "punctuation.comma.grimoire"
                                }
                            ]
                        }
                    ]
                },
                {
                    "begin": "\\b(canal|chan)\\b",
                    "beginCaptures": {
                        "0": {
                            "name": "storage.type.grimoire"
                        }
                    },
                    "end": "(?<=\\))",
                    "patterns": [
                        {
                            "include": "#comment"
                        },
                        {
                            "begin": "\\(",
                            "beginCaptures": {
                                "0": {
                                    "name": "punctuation.parenthesis.open.grimoire"
                                }
                            },
                            "end": "\\)",
                            "endCaptures": {
                                "0": {
                                    "name": "punctuation.parenthesis.close.grimoire"
                                }
                            },
                            "patterns": [
                                {
                                    "include": "#comment"
                                },
                                {
                                    "include": "#type"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        "assignment": {
            "begin": "=",
            "beginCaptures": {
                "0": {
                    "name": "keyword.operator.assignement.grimoire"
                }
            },
            "end": ";",
            "endCaptures": {
                "0": {
                    "name": "punctuation.terminator.grimoire"
                }
            },
            "patterns": [
                {
                    "include": "#comment"
                },
                {
                    "include": "#subexpression"
                }
            ]
        },
        "block": {
            "patterns": [
                {
                    "name": "meta.block.grimoire",
                    "begin": "{",
                    "beginCaptures": {
                        "0": {
                            "name": "punctuation.curlybrace.open.grimoire"
                        }
                    },
                    "end": "}",
                    "endCaptures": {
                        "0": {
                            "name": "punctuation.curlybrace.close.grimoire"
                        }
                    },
                    "patterns": [
                        {
                            "include": "#block_internal"
                        }
                    ]
                }
            ]
        },
        "block_internal": {
            "patterns": [
                {
                    "include": "#expression"
                },
                {
                    "include": "#block"
                }
            ]
        },
        "use": {
            "begin": "\\b(utilise|use)\\b",
            "beginCaptures": {
                "0": {
                    "name": "keyword.control.import.grimoire"
                }
            },
            "end": "(?<=\"|»|})",
            "patterns": [
                {
                    "include": "#comment"
                },
                {
                    "include": "#use-string"
                },
                {
                    "begin": "{",
                    "beginCaptures": {
                        "0": {
                            "name": "punctuation.curlybrace.open.grimoire"
                        }
                    },
                    "end": "}",
                    "endCaptures": {
                        "0": {
                            "name": "punctuation.curlybrace.close.grimoire"
                        }
                    },
                    "patterns": [
                        {
                            "include": "#comment"
                        },
                        {
                            "include": "#use-string"
                        }
                    ]
                }
            ]
        },
        "class-decl": {
            "begin": "\\b(classe|class)\\b",
            "beginCaptures": {
                "0": {
                    "name": "storage.type.class.grimoire"
                }
            },
            "end": "(?<=})",
            "patterns": [
                {
                    "include": "#comment"
                },
                {
                    "begin": "[_[:alpha:]][_[:alnum:]]*[\\?|\\!]?",
                    "beginCaptures": {
                        "0": {
                            "name": "entity.name.class.grimoire"
                        }
                    },
                    "end": "(?<={)",
                    "patterns": [
                        {
                            "include": "#comment"
                        },
                        {
                            "include": "#template-variable-list"
                        },
                        {
                            "begin": ":",
                            "beginCaptures": {
                                "0": {
                                    "name": "punctuation.separator.grimoire"
                                }
                            },
                            "end": "(?<={)",
                            "patterns": [
                                {
                                    "include": "#comment"
                                },
                                {
                                    "match": "[_[:alpha:]][_[:alnum:]]*[\\?|\\!]?",
                                    "name": "entity.other.inherited-class.grimoire"
                                },
                                {
                                    "include": "#template-list"
                                }
                            ]
                        }
                    ]
                },
                {
                    "include": "#template-variable-list"
                },
                {
                    "match": "[_[:alpha:]][_[:alnum:]]*[\\?|\\!]?",
                    "name": "entity.name.class.grimoire"
                },
                {
                    "begin": "(?<={)",
                    "beginCaptures": {
                        "0": {
                            "name": "punctuation.curlybrace.open.grimoire"
                        }
                    },
                    "end": "}",
                    "endCaptures": {
                        "0": {
                            "name": "punctuation.curlybrace.close.grimoire"
                        }
                    },
                    "patterns": [
                        {
                            "include": "#comment"
                        },
                        {
                            "begin": "(?=[_[:alpha:]])",
                            "end": ";",
                            "endCaptures": {
                                "0": {
                                    "name": "punctuation.terminator.grimoire"
                                }
                            },
                            "patterns": [
                                {
                                    "include": "#comment"
                                },
                                {
                                    "include": "#global-keyword"
                                },
                                {
                                    "include": "#type"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        "enum-decl": {
            "begin": "\\b(énum|enum)\\b",
            "beginCaptures": {
                "0": {
                    "name": "storage.type.enum.grimoire"
                }
            },
            "end": "(?<=})",
            "patterns": [
                {
                    "include": "#comment"
                },
                {
                    "match": "[_[:alpha:]][_[:alnum:]]*[\\?|\\!]?",
                    "captures": {
                        "0": {
                            "name": "entity.name.class.grimoire"
                        }
                    }
                },
                {
                    "begin": "(?<={)",
                    "beginCaptures": {
                        "0": {
                            "name": "punctuation.curlybrace.open.grimoire"
                        }
                    },
                    "end": "}",
                    "endCaptures": {
                        "0": {
                            "name": "punctuation.curlybrace.close.grimoire"
                        }
                    },
                    "patterns": [
                        {
                            "include": "#comment"
                        },
                        {
                            "begin": "[_[:alpha:]][_[:alnum:]]*[\\?|\\!]?",
                            "beginCaptures": {
                                "0": {
                                    "name": "entity.name.variable.enum-member.grimoire"
                                }
                            },
                            "end": ";",
                            "endCaptures": {
                                "0": {
                                    "name": "punctuation.terminator.grimoire"
                                }
                            },
                            "patterns": [
                                {
                                    "include": "#comment"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        "type-decl": {
            "begin": "\\btype\\b",
            "beginCaptures": {
                "0": {
                    "name": "storage.type.typealias.grimoire"
                }
            },
            "end": "(?<=;)",
            "patterns": [
                {
                    "include": "#comment"
                },
                {
                    "include": "#type"
                },
                {
                    "include": "#assignment"
                },
                {
                    "include": "#identifier"
                }
            ]
        },
        "template-decl": {
            "begin": "\\b(patron|template)\\b",
            "beginCaptures": {
                "0": {
                    "name": "keyword.control.template.grimoire"
                }
            },
            "end": ";",
            "endCaptures": {
                "0": {
                    "name": "punctuation.terminator.grimoire"
                }
            },
            "patterns": [
                {
                    "include": "#comment"
                },
                {
                    "include": "#template-list"
                },
                {
                    "include": "#type"
                },
                {
                    "include": "#operator"
                },
                {
                    "match": "[_[:alpha:]][_[:alnum:]]*[\\?|\\!]?",
                    "name": "entity.name.function.grimoire"
                }
            ]
        },
        "expression": {
            "patterns": [
                {
                    "include": "#comment"
                },
                {
                    "include": "#operator"
                },
                {
                    "include": "#new"
                },
                {
                    "include": "#punctuation"
                },
                {
                    "include": "#string"
                },
                {
                    "include": "#type"
                },
                {
                    "include": "#literal"
                },
                {
                    "include": "#statement"
                },
                {
                    "include": "#as"
                },
                {
                    "include": "#support"
                },
                {
                    "include": "#call"
                },
                {
                    "include": "#field"
                },
                {
                    "include": "#identifier"
                },
                {
                    "include": "#numeric"
                }
            ]
        },
        "subexpression": {
            "patterns": [
                {
                    "include": "#comment"
                },
                {
                    "include": "#operator"
                },
                {
                    "include": "#new"
                },
                {
                    "include": "#comma"
                },
                {
                    "include": "#string"
                },
                {
                    "include": "#type"
                },
                {
                    "include": "#literal"
                },
                {
                    "include": "#as"
                },
                {
                    "include": "#support"
                },
                {
                    "include": "#call"
                },
                {
                    "include": "#field"
                },
                {
                    "include": "#identifier"
                },
                {
                    "include": "#numeric"
                }
            ]
        },
        "statement": {
            "name": "keyword.control.grimoire",
            "match": "\\b(si|if|sauf|unless|sinon|else|où|switch|sélect|select|cas|case|tant|while|jusque|until|fais|do|boucle|loop|pour|for|retourne|return|tue|kill|tuetous|killall|cède|yield|casse|break|continue|essaie|try|récup|catch|lance|throw|décale|defer)\\b"
        },
        "as": {
            "name": "keyword.control.grimoire",
            "match": "\\b(comme|as)\\b"
        },
        "new": {
            "name": "keyword.other.new.grimoire",
            "match": "\\b(crée|new)\\b"
        },
        "operator": {
            "patterns": [
                {
                    "name": "keyword.operator.arithmetic.grimoire",
                    "match": "<<|>>|=>|->"
                },
                {
                    "name": "keyword.operator.logical.grimoire",
                    "match": "<=>|===|==|!=|\\>=|\\<=|\\>|\\<"
                },
                {
                    "name": "keyword.operator.assignement.grimoire",
                    "match": "\\+=|-=|\\*=|\/=|%=|\\^=|=|~=|<-"
                },
                {
                    "name": "keyword.operator.arithmetic.grimoire",
                    "match": "\\+\\+|\\+|--|-|\\*|\/|%|\\^"
                },
                {
                    "name": "keyword.operator.word.grimoire",
                    "match": "\\b(et|and|ou|or|pas|not|à|to|et_bin|bit_and|ou_bin|bit_or|non_bin|bit_not|ouex_bin|bit_xor)\\b"
                }
            ]
        },
        "punctuation": {
            "patterns": [
                {
                    "include": "#comma"
                },
                {
                    "include": "#semicolon"
                }
            ]
        },
        "call": {
            "patterns": [
                {
                    "include": "#method-call"
                },
                {
                    "include": "#function-call"
                }
            ]
        },
        "function-call": {
            "match": "[_[:alpha:]][_[:alnum:]]*[\\?|\\!]?(?=\\s*\\()",
            "captures": {
                "0": {
                    "patterns": [
                        {
                            "include": "#primitive"
                        },
                        {
                            "name": "entity.name.function.grimoire",
                            "match": "([_[:alpha:]][_[:alnum:]]*[\\?|\\!]?)"
                        }
                    ]
                }
            }
        },
        "field": {
            "match": "(\\.)\\s*([_[:alpha:]][_[:alnum:]]*[\\?|\\!]?)",
            "captures": {
                "1": {
                    "name": "punctuation.accessor.grimoire"
                },
                "2": {
                    "name": "variable.other.grimoire"
                }
            }
        },
        "method-call": {
            "match": ":{1,2}\\s*([_[:alpha:]][_[:alnum:]]*[\\?|\\!]?)",
            "captures": {
                "0": {
                    "name": "punctuation.accessor.grimoire"
                },
                "1": {
                    "patterns": [
                        {
                            "include": "#primitive"
                        },
                        {
                            "name": "entity.name.function.grimoire",
                            "match": "([_[:alpha:]][_[:alnum:]]*[\\?|\\!]?)"
                        }
                    ]
                }
            }
        },
        "use-string": {
            "name": "variable.parameter.import.grimoire",
            "begin": "\"|«",
            "end": "\"|»",
            "patterns": [
                {
                    "name": "constant.character.escape.grimoire",
                    "match": "\\\\."
                }
            ]
        },
        "string": {
            "name": "string.quoted.double.grimoire",
            "begin": "\"|«",
            "end": "\"|»",
            "patterns": [
                {
                    "name": "constant.character.escape.grimoire",
                    "match": "\\\\."
                }
            ]
        },
        "identifier": {
            "name": "entity.name.grimoire",
            "match": "[_[:alpha:]][_[:alnum:]]*[\\?|\\!]?"
        },
        "literal": {
            "patterns": [
                {
                    "name": "variable.language.grimoire",
                    "match": "\\b(soi|self)\\b"
                },
                {
                    "name": "constant.language.grimoire",
                    "match": "\\b(vrai|true|faux|false|null|nul)\\b"
                }
            ]
        },
        "numeric": {
            "patterns": [
                {
                    "name": "constant.numeric.float.grimoire",
                    "match": "([0-9]+[0-9_]*)(\\.[0-9]+)f?"
                },
                {
                    "name": "constant.numeric.float.grimoire",
                    "match": "([0-9][0-9_]*)f"
                },
                {
                    "name": "constant.numeric.float.grimoire",
                    "match": "([0-9][0-9_]*)\\.f?"
                },
                {
                    "name": "constant.numeric.float.grimoire",
                    "match": "\\.([0-9][0-9_]*)f?"
                },
                {
                    "name": "constant.numeric.integer.grimoire",
                    "match": "([0-9][0-9_]*)"
                }
            ]
        },
        "comment": {
            "patterns": [
                {
                    "name": "comment.line.double-slash.grimoire",
                    "match": "\/\/.*"
                },
                {
                    "include": "#comment-multilines"
                }
            ]
        },
        "comment-multilines": {
            "name": "comment.block.grimoire",
            "begin": "\/\\*",
            "end": "\\*\/",
            "patterns": [
                {
                    "include": "#comment-multilines"
                }
            ]
        },
        "comma": {
            "match": ",",
            "name": "punctuation.separator.comma.grimoire"
        },
        "semicolon": {
            "match": ";",
            "name": "punctuation.terminator.grimoire"
        }
    },
    "scopeName": "source.grimoire"
}